<!DOCTYPE html>
<html>
<head>
	<title>分配角色列表</title>
	<link rel="stylesheet" href="/js/lib/layui/css/layui.css">
	
	<script src="/js/lib/layui/layui.js"></script>
	<script type="text/javascript" src="/js/lib/jquery-1.9.1.min.js"></script>
</head>
<body>
	<div class="">
	  	<table id="table" lay-filter="table_event"></table>
	  	<a id="saveUserRole" hidden="">保存</a>
	</div>
	<script type="text/javascript" src="/js/myjs.js"></script>
	<script>
	var table,tableIns,tableId='table';
	var userId = '${userId}';
	function loadUserTable(table){
		var params = {
			 id: "#table",
			 width: 300,
			 url: "/sys/role/pageList?userId="+userId,
			 columns: [
				 {type: 'radio', fixed: 'left'},
				 {type: 'numbers', title: '序号', fixed: 'left'},
			     {field: 'roleName', title: '角色名称',width: 200}
		    ]
		};
		table_layui(table, params);
	}
	layui.use('table', function(){
		table = layui.table;
		var form = layui.form;
		//初始化table
		loadUserTable(table);
	});
	function saveUserRole(){
		var checkStatus = table.checkStatus(tableId);
  		if(checkStatus.data.length > 0){
  			var ids=[];
  			$.each(checkStatus.data, function(index, item){
  				ids.push(item["roleId"]);
  			});
  			var param = {ids:ids, userId:userId};
  			$.ajax({
	  			url: "/sys/user/saveUserRole",
  				type: "post",
  				data: param,
  				success: function(data){
  					if(data.code == "ok"){
  						parent.layer.msg(data.msg,{icon:1});
  						parent.tableIns.reload();
  					}else{
  						parent.layer.msg(data.msg,{icon:0});
  					}
  					//关闭页面
  					closeDialog();
  				}
  			})
  		}else{
  			layer.msg("请至少选择一行记录",{icon:0});
  		}
	}
	</script>
	
</body>
</html>